<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Verticon Tools</title>

<link rel="manifest" href="manifest.json">
<link rel="icon" href="favicon.ico">
<link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">

<link rel="stylesheet" href="src/commonstyles.css">
<link rel="stylesheet" href="src/css/tools_home.css">

<style>
/* ---------- HEADER FIX ---------- */
header {
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding: 14px 16px;
    border-bottom: 1px solid #eee;
}

.logo {
    font-size: 1.3rem;
    font-weight: 700;
}

/* ---------- MOBILE MENU BUTTON ---------- */
.mobile-menu-btn {
    width: 44px;
    height: 44px;
    min-width: 44px;
    min-height: 44px;
    display: flex;
    align-items: center;
    justify-content: center;
    background: transparent;
    border: none;
    cursor: pointer;
}

/* ---------- DROPDOWN MENU ---------- */
.mobile-menu {
    position: fixed;
    top: 58px;
    right: 12px;
    background: #fff;
    border-radius: 12px;
    box-shadow: 0 10px 30px rgba(0,0,0,.15);
    display: none;
    z-index: 2000;
    overflow: hidden;
}

.mobile-menu.active {
    display: block;
}

.mobile-menu-item {
    padding: 14px 18px;
    display: flex;
    align-items: center;
    gap: 12px;
    cursor: pointer;
    border-bottom: 1px solid #eee;
}

.mobile-menu-item:last-child {
    border-bottom: none;
}

.mobile-menu-item:hover {
    background: #f7f7f7;
}

/* ---------- OVERLAY ---------- */
.mobile-menu-overlay {
    position: fixed;
    inset: 0;
    display: none;
    z-index: 1500;
}

.mobile-menu-overlay.active {
    display: block;
}

/* ---------- FOOTER ---------- */
footer {
    margin-top: 4rem;
    padding: 2rem 1rem;
    text-align: center;
    font-size: .85rem;
    color: #666;
    border-top: 1px solid #eee;
}

footer a {
    color: #667eea;
    text-decoration: none;
    font-weight: 600;
}

#cacheTimestamp {
    margin-top: 8px;
    color: #888;
}
</style>
</head>

<body>

<header>
    <div class="logo">Verticon <span class="logogrey">Tools</span></div>

    <button class="mobile-menu-btn" id="mobileMenuBtn">
        <span class="material-icons">more_vert</span>
    </button>
</header>

<div class="mobile-menu-overlay" id="mobileMenuOverlay"></div>

<div class="mobile-menu" id="mobileMenu">
    <div class="mobile-menu-item" id="refreshCacheItem">
        <span class="material-icons">refresh</span>
        <span>Refresh Cache</span>
    </div>
</div>

<main>

<div class="search-container">
    <input type="text" class="tool-search" placeholder="Find a tool (e.g. Merge, Split, Convert)...">
</div>

<div class="tool-category">
    <h2 class="section-title"><span class="material-icons">picture_as_pdf</span> PDF Utilities</h2>
    <div class="tool-grid">
        <a href="pdf-merge" class="tool-card"><h3>Merge PDF</h3><p>Combine multiple PDFs.</p></a>
        <a href="pdf-split" class="tool-card"><h3>Split PDF</h3><p>Split pages or ranges.</p></a>
        <a href="pdf-compress" class="tool-card"><h3>Compress PDF</h3><p>Reduce size safely.</p></a>
    </div>
</div>

<div class="tool-category">
    <h2 class="section-title"><span class="material-icons">image</span> Image Utilities</h2>
    <div class="tool-grid">
        <a href="img-convert" class="tool-card"><h3>Convert Image</h3></a>
        <a href="img-compress" class="tool-card"><h3>Compress Image</h3></a>
        <a href="img-resize" class="tool-card"><h3>Resize Image</h3></a>
        <a href="img-exif" class="tool-card"><h3>EXIF Editor</h3></a>
    </div>
</div>

</main>

<footer>
    <div>
        <a href="/privacy">Privacy</a> · <a href="/terms">Terms</a>
    </div>
    <div id="cacheTimestamp">Cache last refreshed: checking…</div>
</footer>

<script>
const menuBtn = document.getElementById('mobileMenuBtn');
const menu = document.getElementById('mobileMenu');
const overlay = document.getElementById('mobileMenuOverlay');
const refreshBtn = document.getElementById('refreshCacheItem');
const tsEl = document.getElementById('cacheTimestamp');

menuBtn.onclick = () => {
    menu.classList.toggle('active');
    overlay.classList.toggle('active');
};

overlay.onclick = () => {
    menu.classList.remove('active');
    overlay.classList.remove('active');
};

refreshBtn.onclick = () => {
    if (navigator.serviceWorker?.controller) {
        navigator.serviceWorker.controller.postMessage({ type: 'RECACHE_ALL' });
        localStorage.setItem('lastCacheRefresh', Date.now());
        updateTS();
    }
    menu.classList.remove('active');
    overlay.classList.remove('active');
};

function updateTS() {
    const ts = localStorage.getItem('lastCacheRefresh');
    tsEl.textContent = ts
        ? 'Cache last refreshed: ' + new Date(+ts).toLocaleString()
        : 'Cache last refreshed: never';
}

updateTS();
</script>

</body>
</html>
